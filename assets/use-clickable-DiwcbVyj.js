import{r as d,Q as W,U as w,$ as X}from"./index-YGpXjSOi.js";function ee(r){const{wasSelected:t,enabled:e,isSelected:n,mode:a="unmount"}=r;return!!(!e||n||a==="keepMounted"&&t)}function _(r){return r.sort((t,e)=>{const n=t.compareDocumentPosition(e);if(n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(n&Node.DOCUMENT_POSITION_DISCONNECTED||n&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}const Y=r=>typeof r=="object"&&"nodeType"in r&&r.nodeType===Node.ELEMENT_NODE;function M(r,t,e){let n=r+1;return e&&n>=t&&(n=0),n}function v(r,t,e){let n=r-1;return e&&n<0&&(n=t),n}const O=typeof window<"u"?d.useLayoutEffect:d.useEffect,U=r=>r;var $=Object.defineProperty,j=(r,t,e)=>t in r?$(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,u=(r,t,e)=>(j(r,typeof t!="symbol"?t+"":t,e),e);class q{constructor(){u(this,"descendants",new Map),u(this,"register",t=>{if(t!=null)return Y(t)?this.registerNode(t):e=>{this.registerNode(e,t)}}),u(this,"unregister",t=>{this.descendants.delete(t);const e=_(Array.from(this.descendants.keys()));this.assignIndex(e)}),u(this,"destroy",()=>{this.descendants.clear()}),u(this,"assignIndex",t=>{this.descendants.forEach(e=>{const n=t.indexOf(e.node);e.index=n,e.node.dataset.index=e.index.toString()})}),u(this,"count",()=>this.descendants.size),u(this,"enabledCount",()=>this.enabledValues().length),u(this,"values",()=>Array.from(this.descendants.values()).sort((e,n)=>e.index-n.index)),u(this,"enabledValues",()=>this.values().filter(t=>!t.disabled)),u(this,"item",t=>{if(this.count()!==0)return this.values()[t]}),u(this,"enabledItem",t=>{if(this.enabledCount()!==0)return this.enabledValues()[t]}),u(this,"first",()=>this.item(0)),u(this,"firstEnabled",()=>this.enabledItem(0)),u(this,"last",()=>this.item(this.descendants.size-1)),u(this,"lastEnabled",()=>{const t=this.enabledValues().length-1;return this.enabledItem(t)}),u(this,"indexOf",t=>{var e;return t?((e=this.descendants.get(t))==null?void 0:e.index)??-1:-1}),u(this,"enabledIndexOf",t=>t==null?-1:this.enabledValues().findIndex(e=>e.node.isSameNode(t))),u(this,"next",(t,e=!0)=>{const n=M(t,this.count(),e);return this.item(n)}),u(this,"nextEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const a=this.enabledIndexOf(n.node),i=M(a,this.enabledCount(),e);return this.enabledItem(i)}),u(this,"prev",(t,e=!0)=>{const n=v(t,this.count()-1,e);return this.item(n)}),u(this,"prevEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const a=this.enabledIndexOf(n.node),i=v(a,this.enabledCount()-1,e);return this.enabledItem(i)}),u(this,"registerNode",(t,e)=>{if(!t||this.descendants.has(t))return;const n=Array.from(this.descendants.keys()).concat(t),a=_(n);e!=null&&e.disabled&&(e.disabled=!!e.disabled);const i={node:t,index:-1,...e};this.descendants.set(t,i),this.assignIndex(a)})}}function te(){const[r,t]=W({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});return[r,t,()=>{const a=d.useRef(new q);return O(()=>()=>a.current.destroy()),a.current},a=>{const i=t(),[c,o]=d.useState(-1),l=d.useRef(null);O(()=>()=>{l.current&&i.unregister(l.current)},[]),O(()=>{if(!l.current)return;const h=Number(l.current.dataset.index);c!=h&&!Number.isNaN(h)&&o(h)});const m=U(a?i.register(a):i.register);return{descendants:i,index:c,enabledIndex:i.enabledIndexOf(l.current),register:w(m,l)}}]}function H(){const r=d.useRef(new Map),t=r.current,e=d.useCallback((a,i,c,o)=>{r.current.set(c,{type:i,el:a,options:o}),a.addEventListener(i,c,o)},[]),n=d.useCallback((a,i,c,o)=>{a.removeEventListener(i,c,o),r.current.delete(c)},[]);return d.useEffect(()=>()=>{t.forEach((a,i)=>{n(a.el,a.type,i,a.options)})},[n,t]),{add:e,remove:n}}function k(r){var a,i;const t=((i=(a=r.composedPath)==null?void 0:a.call(r))==null?void 0:i[0])??r.target,{tagName:e,isContentEditable:n}=t;return e!=="INPUT"&&e!=="TEXTAREA"&&n!==!0}function se(r={}){const{ref:t,isDisabled:e,isFocusable:n,clickOnEnter:a=!0,clickOnSpace:i=!0,onMouseDown:c,onMouseUp:o,onClick:l,onKeyDown:m,onKeyUp:h,tabIndex:T,onMouseOver:x,onMouseLeave:N,...P}=r,[f,L]=d.useState(!0),[C,I]=d.useState(!1),b=H(),A=s=>{s&&s.tagName!=="BUTTON"&&L(!1)},R=f?T:T||0,p=e&&!n,y=d.useCallback(s=>{if(e){s.stopPropagation(),s.preventDefault();return}s.currentTarget.focus(),l==null||l(s)},[e,l]),D=d.useCallback(s=>{C&&k(s)&&(s.preventDefault(),s.stopPropagation(),I(!1),b.remove(document,"keyup",D,!1))},[C,b]),V=d.useCallback(s=>{if(m==null||m(s),e||s.defaultPrevented||s.metaKey||!k(s.nativeEvent)||f)return;const E=a&&s.key==="Enter";i&&s.key===" "&&(s.preventDefault(),I(!0)),E&&(s.preventDefault(),s.currentTarget.click()),b.add(document,"keyup",D,!1)},[e,f,m,a,i,b,D]),K=d.useCallback(s=>{if(h==null||h(s),e||s.defaultPrevented||s.metaKey||!k(s.nativeEvent)||f)return;i&&s.key===" "&&(s.preventDefault(),I(!1),s.currentTarget.click())},[i,f,e,h]),g=d.useCallback(s=>{s.button===0&&(I(!1),b.remove(document,"mouseup",g,!1))},[b]),B=d.useCallback(s=>{if(s.button!==0)return;if(e){s.stopPropagation(),s.preventDefault();return}f||I(!0),s.currentTarget.focus({preventScroll:!0}),b.add(document,"mouseup",g,!1),c==null||c(s)},[e,f,c,b,g]),F=d.useCallback(s=>{s.button===0&&(f||I(!1),o==null||o(s))},[o,f]),z=d.useCallback(s=>{if(e){s.preventDefault();return}x==null||x(s)},[e,x]),G=d.useCallback(s=>{C&&(s.preventDefault(),I(!1)),N==null||N(s)},[C,N]),S=w(t,A);return f?{...P,ref:S,type:"button","aria-disabled":p?void 0:e,disabled:p,onClick:y,onMouseDown:c,onMouseUp:o,onKeyUp:h,onKeyDown:m,onMouseOver:x,onMouseLeave:N}:{...P,ref:S,role:"button","data-active":X(C),"aria-disabled":e?"true":void 0,tabIndex:p?void 0:R,onClick:y,onMouseDown:B,onMouseUp:F,onKeyUp:K,onKeyDown:V,onMouseOver:z,onMouseLeave:G}}export{te as c,ee as l,se as u};
