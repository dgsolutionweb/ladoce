import{b as z,r as u,d as R,j as e,y as W,M as F,z as J,t as I,A as K,v as A,V as q,D as C,E as y,J as _,w as V,B as o,K as Q,e as G,L as U,C as X,F as Y,N as Z,q as v,T as P,l as E,H as M,p as T,g as O}from"./index-YGpXjSOi.js";import{H as $,T as ee,a as se,b as w,c as h,d as ie,e as x}from"./heading-biKtf4Ne.js";import{A as ae,a as le}from"./alert-dialog-DgUrEwo2.js";const re=({isOpen:m,onClose:d,product:i})=>{const{addProduct:k,updateProduct:j}=z(),[a,f]=u.useState(!1),t=R(),[l,c]=u.useState({name:(i==null?void 0:i.name)||"",cost_price:(i==null?void 0:i.cost_price)||"",sale_price:(i==null?void 0:i.sale_price)||"",stock_quantity:(i==null?void 0:i.stock_quantity)||""}),r=n=>{const{name:g,value:p}=n.target;c(D=>({...D,[g]:p}))},b=async()=>{try{f(!0);const n={name:l.name,cost_price:Number(l.cost_price),sale_price:Number(l.sale_price),stock_quantity:Number(l.stock_quantity)};i!=null&&i.id?(await j({...n,id:i.id}),t({title:"Produto atualizado",description:"O produto foi atualizado com sucesso.",status:"success",duration:3e3,isClosable:!0})):(await k(n),t({title:"Produto adicionado",description:"O produto foi adicionado com sucesso.",status:"success",duration:3e3,isClosable:!0})),d(),c({name:"",cost_price:"",sale_price:"",stock_quantity:""})}catch(n){t({title:"Erro",description:n instanceof Error?n.message:"Erro desconhecido",status:"error",duration:3e3,isClosable:!0})}finally{f(!1)}};return e.jsxs(W,{isOpen:m,onClose:d,onEsc:()=>!a&&d(),closeOnOverlayClick:!a,children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(I,{children:i?"Editar Produto":"Novo Produto"}),e.jsx(K,{isDisabled:a}),e.jsx(A,{children:e.jsxs(q,{spacing:4,children:[e.jsxs(C,{isRequired:!0,children:[e.jsx(y,{children:"Nome"}),e.jsx(_,{name:"name",value:l.name,onChange:r,placeholder:"Nome do produto",isDisabled:a})]}),e.jsxs(C,{isRequired:!0,children:[e.jsx(y,{children:"Preço de Custo"}),e.jsx(_,{name:"cost_price",type:"number",step:"0.01",min:"0",value:l.cost_price,onChange:r,placeholder:"0.00",isDisabled:a})]}),e.jsxs(C,{isRequired:!0,children:[e.jsx(y,{children:"Preço de Venda"}),e.jsx(_,{name:"sale_price",type:"number",step:"0.01",min:"0",value:l.sale_price,onChange:r,placeholder:"0.00",isDisabled:a})]}),e.jsxs(C,{isRequired:!0,children:[e.jsx(y,{children:"Quantidade em Estoque"}),e.jsx(_,{name:"stock_quantity",type:"number",min:"0",value:l.stock_quantity,onChange:r,placeholder:"0",isDisabled:a})]})]})}),e.jsxs(V,{children:[e.jsx(o,{variant:"ghost",mr:3,onClick:d,isDisabled:a,children:"Cancelar"}),e.jsx(o,{colorScheme:"purple",onClick:b,isLoading:a,children:i?"Salvar":"Adicionar"})]})]})]})},ce=()=>{const{products:m,loading:d,deleteProduct:i}=z(),{isOpen:k,onOpen:j,onClose:a}=Q(),[f,t]=u.useState(null),[l,c]=u.useState(!1),[r,b]=u.useState(null),n=u.useRef(null),g=R(),p=G("white","gray.800"),D=U({base:!0,md:!1}),S=s=>{t(s),j()},N=s=>{b(s),c(!0)},B=async()=>{if(r)try{await i(r.id),g({title:"Produto excluído",description:"O produto foi excluído com sucesso.",status:"success",duration:3e3,isClosable:!0})}catch(s){g({title:"Erro ao excluir",description:s instanceof Error?s.message:"Erro desconhecido",status:"error",duration:3e3,isClosable:!0})}finally{c(!1),b(null)}},H=()=>{t(null),a()},L=()=>{t(null),j()};return e.jsxs(X,{maxW:"container.xl",py:8,children:[e.jsxs(Y,{justify:"space-between",align:"center",mb:8,children:[e.jsx($,{size:"lg",children:"Produtos"}),e.jsx(o,{leftIcon:e.jsx(Z,{}),colorScheme:"purple",onClick:L,isLoading:d,children:"Novo Produto"})]}),e.jsx(v,{bg:p,borderRadius:"lg",shadow:"sm",overflow:"hidden",children:D?e.jsx(q,{spacing:4,align:"stretch",p:4,children:m.map(s=>e.jsx(v,{p:4,borderWidth:"1px",borderRadius:"md",bg:p,children:e.jsxs(q,{align:"stretch",spacing:2,children:[e.jsx(P,{fontWeight:"bold",children:s.name}),e.jsxs(P,{children:["Preço de Custo: ",E(s.cost_price)]}),e.jsxs(P,{children:["Preço de Venda: ",E(s.sale_price)]}),e.jsxs(P,{children:["Estoque: ",s.stock_quantity]}),e.jsxs(M,{spacing:2,children:[e.jsx(o,{size:"sm",colorScheme:"blue",leftIcon:e.jsx(T,{}),onClick:()=>S(s),flex:1,children:"Editar"}),e.jsx(o,{size:"sm",colorScheme:"red",leftIcon:e.jsx(O,{}),onClick:()=>N(s),flex:1,children:"Excluir"})]})]})},s.id))}):e.jsxs(ee,{variant:"simple",children:[e.jsx(se,{children:e.jsxs(w,{children:[e.jsx(h,{children:"Nome"}),e.jsx(h,{isNumeric:!0,children:"Preço de Custo"}),e.jsx(h,{isNumeric:!0,children:"Preço de Venda"}),e.jsx(h,{isNumeric:!0,children:"Estoque"}),e.jsx(h,{width:"200px",children:"Ações"})]})}),e.jsx(ie,{children:m.map(s=>e.jsxs(w,{children:[e.jsx(x,{children:s.name}),e.jsx(x,{isNumeric:!0,children:E(s.cost_price)}),e.jsx(x,{isNumeric:!0,children:E(s.sale_price)}),e.jsx(x,{isNumeric:!0,children:s.stock_quantity}),e.jsx(x,{children:e.jsxs(M,{spacing:2,children:[e.jsx(o,{size:"sm",colorScheme:"blue",leftIcon:e.jsx(T,{}),onClick:()=>S(s),children:"Editar"}),e.jsx(o,{size:"sm",colorScheme:"red",leftIcon:e.jsx(O,{}),onClick:()=>N(s),children:"Excluir"})]})})]},s.id))})]})}),e.jsx(re,{isOpen:k,onClose:H,product:f}),e.jsx(ae,{isOpen:l,leastDestructiveRef:n,onClose:()=>c(!1),children:e.jsx(F,{children:e.jsxs(le,{children:[e.jsx(I,{fontSize:"lg",fontWeight:"bold",children:"Excluir Produto"}),e.jsxs(A,{children:['Tem certeza que deseja excluir o produto "',r==null?void 0:r.name,'"? Esta ação não pode ser desfeita.']}),e.jsxs(V,{children:[e.jsx(o,{ref:n,onClick:()=>c(!1),children:"Cancelar"}),e.jsx(o,{colorScheme:"red",onClick:B,ml:3,children:"Excluir"})]})]})})})]})};export{ce as default};
