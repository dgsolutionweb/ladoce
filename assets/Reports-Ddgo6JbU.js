import{O as z,r as S,Q as q,R as U,U as ne,W as ae,f as M,X as oe,Y as re,j as e,c as N,a as E,Z as G,b as le,K as ce,e as ie,C as de,F as he,H as ue,B as xe,N as be,S as v,h as C,i as P,I as V,k as me,l as I,m as je,n as pe,V as W,q as F}from"./index-YGpXjSOi.js";import{a as fe,S as X,E as ge}from"./ExpenseModal-BDL2cwSb.js";import{H as R,T as A,a as H,b as _,c as y,d as O,e as T}from"./heading-biKtf4Ne.js";import{c as ye,u as Te,l as Se}from"./use-clickable-DiwcbVyj.js";function De(o){const{value:s,defaultValue:n,onChange:a,shouldUpdate:r=(x,d)=>x!==d}=o,i=z(a),u=z(r),[l,c]=S.useState(n),t=s!==void 0,b=t?s:l,m=z(x=>{const g=typeof x=="function"?x(b):x;u(b,g)&&(t||c(g),i(g))},[t,i,b,u]);return[b,m]}const[ve,Ce,Pe,we]=ye();function Ie(o){const{defaultIndex:s,onChange:n,index:a,isManual:r,isLazy:i,lazyBehavior:u="unmount",orientation:l="horizontal",direction:c="ltr",...t}=o,[b,m]=S.useState(s??0),[x,d]=De({defaultValue:s??0,value:a,onChange:n});S.useEffect(()=>{a!=null&&m(a)},[a]);const g=Pe(),D=S.useId();return{id:`tabs-${o.id??D}`,selectedIndex:x,focusedIndex:b,setSelectedIndex:d,setFocusedIndex:m,isManual:r,isLazy:i,lazyBehavior:u,orientation:l,descendants:g,direction:c,htmlProps:t}}const[_e,B]=q({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function ke(o){const{focusedIndex:s,orientation:n,direction:a}=B(),r=Ce(),i=S.useCallback(u=>{const l=()=>{var p;const j=r.nextEnabled(s);j&&((p=j.node)==null||p.focus())},c=()=>{var p;const j=r.prevEnabled(s);j&&((p=j.node)==null||p.focus())},t=()=>{var p;const j=r.firstEnabled();j&&((p=j.node)==null||p.focus())},b=()=>{var p;const j=r.lastEnabled();j&&((p=j.node)==null||p.focus())},m=n==="horizontal",x=n==="vertical",d=u.key,g=a==="ltr"?"ArrowLeft":"ArrowRight",D=a==="ltr"?"ArrowRight":"ArrowLeft",w={[g]:()=>m&&c(),[D]:()=>m&&l(),ArrowDown:()=>x&&l(),ArrowUp:()=>x&&c(),Home:t,End:b}[d];w&&(u.preventDefault(),w(u))},[r,s,n,a]);return{...o,role:"tablist","aria-orientation":n,onKeyDown:U(o.onKeyDown,i)}}function Re(o){const{isDisabled:s=!1,isFocusable:n=!1,...a}=o,{setSelectedIndex:r,isManual:i,id:u,setFocusedIndex:l,selectedIndex:c}=B(),{index:t,register:b}=we({disabled:s&&!n}),m=t===c,x=()=>{r(t)},d=()=>{l(t),!i&&!(s&&n)&&r(t)};return{...Te({...a,ref:ne(b,o.ref),isDisabled:s,isFocusable:n,onClick:U(o.onClick,x)}),id:Q(u,t),role:"tab",tabIndex:m?0:-1,type:"button","aria-selected":m,"aria-controls":Y(u,t),onFocus:s?void 0:U(o.onFocus,d)}}const[Me,Ne]=q({});function Ee(o){const s=B(),{id:n,selectedIndex:a}=s,i=ae(o.children).map((u,l)=>S.createElement(Me,{key:u.key??l,value:{isSelected:l===a,id:Y(n,l),tabId:Q(n,l),selectedIndex:a}},u));return{...o,children:i}}function Fe(o){const{children:s,...n}=o,{isLazy:a,lazyBehavior:r}=B(),{isSelected:i,id:u,tabId:l}=Ne(),c=S.useRef(!1);i&&(c.current=!0);const t=Se({wasSelected:c.current,isSelected:i,enabled:a,mode:r});return{tabIndex:0,...n,children:t?s:null,role:"tabpanel","aria-labelledby":l,hidden:!i,id:u}}function Q(o,s){return`${o}--tab-${s}`}function Y(o,s){return`${o}--tabpanel-${s}`}const[Be,L]=q({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),Z=M(function(s,n){const a=oe("Tabs",s),{children:r,className:i,...u}=re(s),{htmlProps:l,descendants:c,...t}=Ie(u),b=S.useMemo(()=>t,[t]),{isFitted:m,...x}=l,d={position:"relative",...a.root};return e.jsx(ve,{value:c,children:e.jsx(_e,{value:b,children:e.jsx(Be,{value:a,children:e.jsx(N.div,{className:E("chakra-tabs",i),ref:n,...x,__css:d,children:r})})})})});Z.displayName="Tabs";const K=M(function(s,n){const a=L(),r=Re({...s,ref:n}),i=G({outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...a.tab});return e.jsx(N.button,{...r,className:E("chakra-tabs__tab",s.className),__css:i})});K.displayName="Tab";const J=M(function(s,n){const a=ke({...s,ref:n}),r=L(),i=G({display:"flex",...r.tablist});return e.jsx(N.div,{...a,className:E("chakra-tabs__tablist",s.className),__css:i})});J.displayName="TabList";const $=M(function(s,n){const a=Fe({...s,ref:n}),r=L();return e.jsx(N.div,{outline:"0",...a,className:E("chakra-tabs__tab-panel",s.className),__css:r.tabpanel})});$.displayName="TabPanel";const ee=M(function(s,n){const a=Ee(s),r=L();return e.jsx(N.div,{...a,width:"100%",ref:n,className:E("chakra-tabs__tab-panels",s.className),__css:r.tabpanels})});ee.displayName="TabPanels";const He=()=>{const{sales:o,expenses:s}=le(),[n,a]=S.useState(new Date().toISOString().slice(0,7)),{isOpen:r,onOpen:i,onClose:u}=ce(),l=ie("white","gray.800"),c=S.useMemo(()=>{const[t,b]=n.split("-"),m=new Date(parseInt(t),parseInt(b)-1,1),x=new Date(parseInt(t),parseInt(b),0),d=o.filter(h=>{const f=new Date(h.date);return f>=m&&f<=x}),g=s.filter(h=>{const f=new Date(h.date);return f>=m&&f<=x}),D=d.reduce((h,f)=>h+f.total_amount,0),k=g.reduce((h,f)=>h+f.amount,0),w=D-k,j=d.length>0?D/d.length:0,p=d.filter(h=>h.delivery).length,se={cash:d.filter(h=>h.payment_method==="cash").length,credit:d.filter(h=>h.payment_method==="credit").length,debit:d.filter(h=>h.payment_method==="debit").length,pix:d.filter(h=>h.payment_method==="pix").length},te=g.reduce((h,f)=>(h[f.category]=(h[f.category]||0)+f.amount,h),{});return{totalSales:D,totalExpenses:k,netProfit:w,averageTicket:j,deliveryCount:p,paymentMethods:se,expensesByCategory:te,sales:d,expenses:g}},[o,s,n]);return e.jsxs(de,{maxW:"container.xl",py:8,children:[e.jsxs(he,{justify:"space-between",align:"center",mb:8,children:[e.jsx(R,{size:"lg",children:"Relatórios"}),e.jsxs(ue,{spacing:4,children:[e.jsx(fe,{value:n,onChange:t=>a(t.target.value),w:"200px",children:Array.from({length:12},(t,b)=>{const m=new Date;m.setMonth(m.getMonth()-b);const x=m.toISOString().slice(0,7),d=m.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});return e.jsx("option",{value:x,children:d},x)})}),e.jsx(xe,{leftIcon:e.jsx(be,{}),colorScheme:"purple",onClick:i,children:"Nova Despesa"})]})]}),e.jsxs(X,{columns:{base:1,md:3},spacing:6,mb:8,children:[e.jsxs(v,{p:4,bg:l,borderRadius:"lg",shadow:"sm",children:[e.jsx(C,{children:"Receita Bruta"}),e.jsxs(P,{color:"green.500",children:[e.jsx(V,{as:me,mr:2}),I(c.totalSales)]})]}),e.jsxs(v,{p:4,bg:l,borderRadius:"lg",shadow:"sm",children:[e.jsx(C,{children:"Despesas Totais"}),e.jsxs(P,{color:"red.500",children:[e.jsx(V,{as:je,mr:2}),I(c.totalExpenses)]})]}),e.jsxs(v,{p:4,bg:l,borderRadius:"lg",shadow:"sm",children:[e.jsx(C,{children:"Lucro Líquido"}),e.jsxs(P,{color:c.netProfit>=0?"green.500":"red.500",children:[e.jsx(V,{as:pe,mr:2}),I(c.netProfit)]})]})]}),e.jsxs(Z,{variant:"enclosed",mb:8,children:[e.jsxs(J,{children:[e.jsx(K,{children:"Vendas"}),e.jsx(K,{children:"Despesas"})]}),e.jsxs(ee,{children:[e.jsx($,{p:0,pt:4,children:e.jsxs(W,{spacing:6,align:"stretch",children:[e.jsxs(F,{bg:l,p:4,borderRadius:"lg",shadow:"sm",children:[e.jsx(R,{size:"md",mb:4,children:"Métodos de Pagamento"}),e.jsxs(X,{columns:{base:2,md:4},spacing:4,children:[e.jsxs(v,{children:[e.jsx(C,{children:"Dinheiro"}),e.jsx(P,{children:c.paymentMethods.cash})]}),e.jsxs(v,{children:[e.jsx(C,{children:"Crédito"}),e.jsx(P,{children:c.paymentMethods.credit})]}),e.jsxs(v,{children:[e.jsx(C,{children:"Débito"}),e.jsx(P,{children:c.paymentMethods.debit})]}),e.jsxs(v,{children:[e.jsx(C,{children:"PIX"}),e.jsx(P,{children:c.paymentMethods.pix})]})]})]}),e.jsxs(F,{bg:l,p:4,borderRadius:"lg",shadow:"sm",children:[e.jsx(R,{size:"md",mb:4,children:"Vendas do Período"}),e.jsxs(A,{variant:"simple",children:[e.jsx(H,{children:e.jsxs(_,{children:[e.jsx(y,{children:"Data"}),e.jsx(y,{children:"Valor"}),e.jsx(y,{children:"Pagamento"}),e.jsx(y,{children:"Entrega"})]})}),e.jsx(O,{children:c.sales.map(t=>e.jsxs(_,{children:[e.jsx(T,{children:new Date(t.date).toLocaleDateString("pt-BR")}),e.jsx(T,{children:I(t.total_amount)}),e.jsx(T,{children:t.payment_method}),e.jsx(T,{children:t.delivery?"Sim":"Não"})]},t.id))})]})]})]})}),e.jsx($,{p:0,pt:4,children:e.jsxs(W,{spacing:6,align:"stretch",children:[e.jsxs(F,{bg:l,p:4,borderRadius:"lg",shadow:"sm",children:[e.jsx(R,{size:"md",mb:4,children:"Despesas por Categoria"}),e.jsxs(A,{variant:"simple",children:[e.jsx(H,{children:e.jsxs(_,{children:[e.jsx(y,{children:"Categoria"}),e.jsx(y,{children:"Total"})]})}),e.jsx(O,{children:Object.entries(c.expensesByCategory).map(([t,b])=>e.jsxs(_,{children:[e.jsx(T,{children:t}),e.jsx(T,{children:I(b)})]},t))})]})]}),e.jsxs(F,{bg:l,p:4,borderRadius:"lg",shadow:"sm",children:[e.jsx(R,{size:"md",mb:4,children:"Despesas do Período"}),e.jsxs(A,{variant:"simple",children:[e.jsx(H,{children:e.jsxs(_,{children:[e.jsx(y,{children:"Data"}),e.jsx(y,{children:"Descrição"}),e.jsx(y,{children:"Categoria"}),e.jsx(y,{children:"Valor"})]})}),e.jsx(O,{children:c.expenses.map(t=>e.jsxs(_,{children:[e.jsx(T,{children:new Date(t.date).toLocaleDateString("pt-BR")}),e.jsx(T,{children:t.description}),e.jsx(T,{children:t.category}),e.jsx(T,{children:I(t.amount)})]},t.id))})]})]})]})})]})]}),e.jsx(ge,{isOpen:r,onClose:u})]})};export{He as default};
